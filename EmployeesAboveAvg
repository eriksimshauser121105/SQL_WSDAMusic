/*
Created by Erik Simshauser
Created on 1/21/2026
Desc: Get a list of employees who exceeded
			the average transaction amount from sales 
			they generated during 2011 and 2012.
*/

SELECT
	e.FirstName || ' ' || e.LastName as SalesRepName,
	(sum(i.total)) as TotalTransactionAmount
FROM
	Invoice as i
INNER JOIN
	Customer as c
ON
	i.CustomerId = c.CustomerId
INNER JOIN
	Employee as e
ON
	c.SupportRepId = e.EmployeeId
WHERE
	 i.total > (SELECT
	round(avg(total),2)
FROM
	Invoice
WHERE (strftime('%Y', InvoiceDate) = '2011') OR (strftime('%Y', InvoiceDate) = '2012')) 
GROUP BY
	SalesRepName
ORDER BY
	e.LastName
